<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DFIR Analysis Documentation Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .input-section {
            padding: 40px;
            background: white;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .bulk-import {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .bulk-import h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .bulk-import textarea {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            margin-bottom: 15px;
        }

        .bulk-import textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .bulk-import .btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .bulk-import .btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .task-item {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.1);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .task-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1em;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .task-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e74c3c;
        }

        .status-indicator.complete {
            background: #27ae60;
        }

        .remove-task {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .remove-task:hover {
            background: #c0392b;
            transform: translateY(-1px);
        }

        .task-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .image-upload {
            border: 2px dashed #667eea;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9ff;
            margin-top: 15px;
        }

        .image-upload:hover {
            border-color: #5a6fd8;
            background: #f0f4ff;
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .controls {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .task-counter {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .output {
            margin-top: 40px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .output-header {
            background: #34495e;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: #2980b9;
        }

        .markdown-output {
            padding: 30px;
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            border-top: 1px solid #e9ecef;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .quick-add {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .quick-add h4 {
            margin-bottom: 15px;
        }

        .quick-add input {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            margin-right: 10px;
            width: 100px;
        }

        .quick-add input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç DFIR Analysis Documentation Generator</h1>
            <p>Task-focused documentation for HTB Sherlock challenges</p>
        </div>

        <div class="input-section">
            <!-- Basic Info -->
            <div class="form-group">
                <label for="title">üìã Investigation Title</label>
                <input type="text" id="title" placeholder="e.g., ReachKart - DFIR Analysis (HackTheBox)">
            </div>

            <div class="form-group">
                <label for="scenario">üìñ Scenario Overview</label>
                <textarea id="scenario" placeholder="Describe the investigation scenario..."></textarea>
            </div>

            <!-- Quick Task Setup -->
            <div class="quick-add">
                <h4>‚ö° Quick Setup</h4>
                <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
                    <input type="number" id="task-count" placeholder="15" min="1" max="50">
                    <button class="btn btn-secondary" onclick="createTasks()" style="margin: 0;">Create Tasks</button>
                    <span style="opacity: 0.8;">Create empty tasks to fill in questions</span>
                </div>
            </div>

            <!-- Bulk Import -->
            <div class="bulk-import">
                <h3>üìù Bulk Import Questions</h3>
                <textarea id="bulk-questions" placeholder="Paste all your HTB questions here, one per line:&#10;1. What was the vulnerable endpoint?&#10;2. When was the attack launched?&#10;3. What tool was used?"></textarea>
                <button class="btn" onclick="importBulkQuestions()">‚ö° Import Questions</button>
                <p style="margin-top: 10px; opacity: 0.8; font-size: 0.9em;">
                    üí° Tip: Copy all questions from HTB and paste here - they'll be automatically parsed and numbered!
                </p>
            </div>

            <!-- Task Counter -->
            <div class="task-counter">
                <span id="task-stats">üìã 0 Tasks Created | ‚úÖ 0 Complete | üìù 0 Remaining</span>
            </div>

            <!-- Tasks Container -->
            <div id="tasks-container">
                <!-- Tasks will be added here dynamically -->
            </div>

            <div class="controls">
                <button class="btn btn-secondary" onclick="addSingleTask()">‚ûï Add Single Task</button>
                <button class="btn btn-primary" onclick="generateMarkdown()">üöÄ Generate Documentation</button>
                <button class="btn btn-success" onclick="downloadMarkdown()">üíæ Download Markdown</button>
            </div>
        </div>

        <div id="output" class="output" style="display: none;">
            <div class="output-header">
                <h3>üìÑ Generated Markdown</h3>
                <button class="copy-btn" onclick="copyToClipboard()">üìã Copy</button>
            </div>
            <div id="markdown-output" class="markdown-output"></div>
        </div>
    </div>

    <script>
        let tasks = [];
        let taskCounter = 0;

        function createTasks() {
            const count = parseInt(document.getElementById('task-count').value) || 10;
            tasks = [];
            taskCounter = 0;
            
            for (let i = 1; i <= count; i++) {
                tasks.push({
                    id: i,
                    number: i,
                    question: '',
                    answer: '',
                    explanation: '',
                    image: null
                });
            }
            taskCounter = count;
            renderTasks();
            updateTaskStats();
        }

        function addSingleTask() {
            taskCounter++;
            tasks.push({
                id: taskCounter,
                number: taskCounter,
                question: '',
                answer: '',
                explanation: '',
                image: null
            });
            renderTasks();
            updateTaskStats();
        }

        function removeTask(taskId) {
            tasks = tasks.filter(t => t.id !== taskId);
            // Renumber tasks
            tasks.forEach((task, index) => {
                task.number = index + 1;
            });
            renderTasks();
            updateTaskStats();
        }

        function importBulkQuestions() {
            const bulkText = document.getElementById('bulk-questions').value.trim();
            if (!bulkText) {
                alert('Please enter questions to import');
                return;
            }

            const lines = bulkText.split('\n').filter(line => line.trim());
            tasks = [];
            taskCounter = 0;

            lines.forEach((line, index) => {
                const cleanLine = line.replace(/^\d+\.?\s*/, '').trim();
                if (cleanLine) {
                    taskCounter++;
                    tasks.push({
                        id: taskCounter,
                        number: taskCounter,
                        question: cleanLine.endsWith('?') ? cleanLine : cleanLine + '?',
                        answer: '',
                        explanation: '',
                        image: null
                    });
                }
            });

            renderTasks();
            updateTaskStats();
            document.getElementById('bulk-questions').value = '';
            alert(`Imported ${tasks.length} questions successfully!`);
        }

        function updateTask(taskId, field, value) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task[field] = value;
                updateTaskStats();
            }
        }

        function handleImageUpload(taskId, event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const task = tasks.find(t => t.id === taskId);
                    task.image = e.target.result;
                    renderTasks();
                };
                reader.readAsDataURL(file);
            }
        }

        function updateTaskStats() {
            const totalTasks = tasks.length;
            const completeTasks = tasks.filter(t => t.question && t.answer).length;
            const remainingTasks = totalTasks - completeTasks;
            
            document.getElementById('task-stats').textContent = 
                `üìã ${totalTasks} Tasks Created | ‚úÖ ${completeTasks} Complete | üìù ${remainingTasks} Remaining`;
        }

        function renderTasks() {
            const container = document.getElementById('tasks-container');
            container.innerHTML = '';

            tasks.forEach(task => {
                const taskDiv = document.createElement('div');
                taskDiv.className = 'task-item fade-in';
                
                const isComplete = task.question && task.answer;
                
                taskDiv.innerHTML = `
                    <div class="task-header">
                        <span class="task-number">Task ${task.number}</span>
                        <div class="task-status">
                            <span class="status-indicator ${isComplete ? 'complete' : ''}"></span>
                            <span style="font-size: 0.9em; color: #666;">
                                ${isComplete ? 'Complete' : 'Incomplete'}
                            </span>
                            <button class="remove-task" onclick="removeTask(${task.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                    
                    <div class="task-content">
                        <div class="form-group">
                            <label>Question</label>
                            <input type="text" value="${task.question}" 
                                   onchange="updateTask(${task.id}, 'question', this.value)"
                                   placeholder="What was the vulnerable endpoint that allowed the attacker to leak files?">
                        </div>
                        
                        <div class="form-group">
                            <label>Answer</label>
                            <input type="text" value="${task.answer}"
                                   onchange="updateTask(${task.id}, 'answer', this.value)"
                                   placeholder="/user/getOrderBill">
                        </div>
                        
                        <div class="form-group">
                            <label>Additional Explanation/Analysis (Optional)</label>
                            <textarea onchange="updateTask(${task.id}, 'explanation', this.value)"
                                      placeholder="Provide detailed analysis, methodology, or additional context for this task...">${task.explanation}</textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Screenshot/Evidence (Optional)</label>
                            <div class="image-upload" onclick="document.getElementById('img-${task.id}').click()">
                                ${task.image ? 
                                    `<img src="${task.image}" class="image-preview" alt="Task ${task.number} Screenshot">
                                     <p>Click to change image</p>` :
                                    `<p>üì∑ Click to upload screenshot</p>`
                                }
                            </div>
                            <input type="file" id="img-${task.id}" accept="image/*" style="display: none;"
                                   onchange="handleImageUpload(${task.id}, event)">
                        </div>
                    </div>
                `;
                
                container.appendChild(taskDiv);
            });
        }

        function generateMarkdown() {
            const title = document.getElementById('title').value || 'DFIR Analysis Report';
            const scenario = document.getElementById('scenario').value || 'Investigation scenario...';
            
            let markdown = `# ![logo](https://github.com/user-attachments/assets/739ac72d-d6a0-4e10-abbb-31c46fccc07b) ${title}\n\n`;
            markdown += `## Scenario Overview\n\n${scenario}\n\n---\n\n`;
            markdown += `## Investigation Tasks\n\n`;

            tasks.forEach(task => {
                if (task.question) {
                    markdown += `### Task ${task.number}\n`;
                    markdown += `**Question:** ${task.question}\n`;
                    
                    if (task.answer) {
                        markdown += `**Answer:** \`${task.answer}\`\n\n`;
                    } else {
                        markdown += `**Answer:** \`[Not answered yet]\`\n\n`;
                    }
                    
                    if (task.explanation) {
                        markdown += `${task.explanation}\n\n`;
                    }
                    
                    if (task.image) {
                        markdown += `![Task ${task.number} Screenshot](data:image/png;base64,${task.image.split(',')[1]})\n\n`;
                    }
                    
                    markdown += `---\n\n`;
                }
            });

            markdown += `### Summary\n\n`;
            markdown += `Investigation completed successfully. Key findings and recommendations documented above.\n\n---`;

            document.getElementById('markdown-output').textContent = markdown;
            document.getElementById('output').style.display = 'block';
            document.getElementById('output').scrollIntoView({ behavior: 'smooth' });
        }

        function copyToClipboard() {
            const markdown = document.getElementById('markdown-output').textContent;
            navigator.clipboard.writeText(markdown).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Copied!';
                setTimeout(() => btn.textContent = originalText, 2000);
            });
        }

        function downloadMarkdown() {
            const markdown = document.getElementById('markdown-output').textContent;
            const title = document.getElementById('title').value || 'DFIR_Analysis_Report';
            const filename = `${title.replace(/[^a-zA-Z0-9]/g, '_')}.md`;
            
            const blob = new Blob([markdown], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize
        updateTaskStats();
    </script>
</body>
</html>
